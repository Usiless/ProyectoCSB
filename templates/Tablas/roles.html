{% extends 'base.html' %}
{% block title %}{{title}}{% endblock %}
{% block content %}
<style>
    .chk_th {
        float: right
    }
</style>
<div class="container">
    <form method="post" id="myForm" onSubmit="return confirm('Confirmar cambios?');">
        <div>
            <div class="mt-3 col-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" name="nombre" required autofocus value="{{data[1]}}" />
            </div>
            <div class="mb-3 col-9">
                <label for="descripcion" class="form-label">Descripción</label>
                <textarea class="form-control" id="descripcion" rows="2" name="descripcion">{{data[2]}}</textarea>
            </div>
        </div>
        <div class="col-md-12 column">
            <table class="table table-bordered table-hover" id="tab_logic">
                <thead>
                    <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">Tabla</th>
                        <th class="">
                            Crear
                            <input class="form-check-input chk_th" type="checkbox" name="all_crear" onclick="tick_all(this)" afecta="crear">
                        </th>
                        <th class="">
                            Leer
                            <input class="form-check-input chk_th" type="checkbox" name="all_leer" onclick="tick_all(this)" afecta="leer">
                        </th>
                        <th class="">
                            Modificar
                            <input class="form-check-input chk_th" type="checkbox" name="all_modif" onclick="tick_all(this)" afecta="modificar">
                        </th>
                        <th class="">
                            Eliminar
                            <input class="form-check-input chk_th" type="checkbox" name="all_elim" onclick="tick_all(this)" afecta="eliminar">
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {%for row in data_det%}
                    <tr id='addr_{{loop.index-1}}_tab_logic'>
                        <td class="text-center align-middle">{{loop.index}}</td>
                        <td hidden><input type="text" id='id_tabla' name="id_tabla" class="form-control det" value={{row[0]}} /></td>
                        <td class="align-middle col-3">{{row[1]}}</td>
                        <td class="align-middle text-center">
                            <select id="crear" class="form-select" name="crear">
                                <option value=0 {%if row[2]==0%} selected {%endif%}>No</option>
                                <option value=1 {%if row[2]==1%} selected {%endif%}>Si</option>
                            </select>
                        </td>
                        <td class="align-middle text-center">
                            <select id="leer" class="form-select" name="leer">
                                <option value=0 {%if row[3]==0%} selected {%endif%}>No</option>
                                <option value=1 {%if row[3]==1%} selected {%endif%}>Si</option>
                            </select>
                        </td>
                        <td class="align-middle text-center">
                            <select id="modificar" class="form-select" name="modificar">
                                <option value=0 {%if row[4]==0%} selected {%endif%}>No</option>
                                <option value=1 {%if row[4]==1%} selected {%endif%}>Si</option>
                            </select>
                        </td>
                        <td class="align-middle text-center">
                            <select id="eliminar" class="form-select" name="eliminar">
                                <option value=0 {%if row[5]==0%} selected {%endif%}>No</option>
                                <option value=1 {%if row[5]==1%} selected {%endif%}>Si</option>
                            </select>
                        </td>
                    </tr>
                    {%endfor%}
                </tbody>
            </table>
        </div>
        <div id="botones" class="d-grid gap-2 d-md-flex justify-content-md-end"></div>
    </form>
</div>
<script>
    function tick_all(check) {
        let det_checks = document.getElementsByName(check.getAttribute("afecta"))
        for (let i = 0; i < det_checks.length; i++) {
            if (check.checked == true) {
                det_checks[i].value = 1;
            }
            else {
                det_checks[i].value = 0;
            }
        }
    }
</script>
<script type="text/javascript" id="botones_js" data="{{ data }}" actualizar="{{ permisos[0] }}" eliminar="{{ permisos[1] }}" src="{{url_for('static', filename='generar_botones.js')}}"></script>
{% endblock %}
